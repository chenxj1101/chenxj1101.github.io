<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>argparse包使用</title>
      <link href="/2018/02/20/argparse-bao-shi-yong/"/>
      <url>/2018/02/20/argparse-bao-shi-yong/</url>
      
        <content type="html"><![CDATA[<h2 id="Argparse简介"><a href="#Argparse简介" class="headerlink" title="Argparse简介"></a>Argparse简介</h2><p>argparse是python自带的一个命令行解析包，非常适合编写可读性好的命令行程序。<br>要使用的话，直接导入即可，无需另外安装。</p><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>新建一个 <code>parse.py</code>文件如下：</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># !/usr/bin/python</span><span class="token comment" spellcheck="true"># -*- coding: UTF-8 -*-</span><span class="token keyword">import</span> argparse<span class="token comment" spellcheck="true"># get parameters</span><span class="token keyword">def</span> <span class="token function">parse_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    description <span class="token operator">=</span> u<span class="token string">"扫描给定项目路径，生成路径下数据信息"</span>    parse <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span>description<span class="token punctuation">)</span>    help <span class="token operator">=</span> u<span class="token string">"输出文件名称"</span>    parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'output'</span><span class="token punctuation">,</span> help<span class="token operator">=</span>help<span class="token punctuation">)</span>    help <span class="token operator">=</span> u<span class="token string">"已记录好的总表，如不存在可用'-'代替"</span>    parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'backup'</span><span class="token punctuation">,</span> help<span class="token operator">=</span>help<span class="token punctuation">)</span>    help <span class="token operator">=</span> u<span class="token string">"需要扫描的项目目录,可输入多个"</span>    parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'filepath'</span><span class="token punctuation">,</span> nargs<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">,</span> help<span class="token operator">=</span>help<span class="token punctuation">)</span>    help <span class="token operator">=</span> u<span class="token string">"项目名称"</span>    parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-p'</span><span class="token punctuation">,</span><span class="token string">'--project'</span><span class="token punctuation">,</span> help<span class="token operator">=</span>help<span class="token punctuation">)</span>    help <span class="token operator">=</span> u<span class="token string">"数据类型, 默认值为: FASTQ"</span>    parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-t'</span><span class="token punctuation">,</span><span class="token string">'--type'</span><span class="token punctuation">,</span>default<span class="token operator">=</span><span class="token string">'FASTQ'</span> <span class="token punctuation">,</span> help<span class="token operator">=</span>help<span class="token punctuation">)</span>    help <span class="token operator">=</span> u<span class="token string">"测序平台, 默认值为: Illumina"</span>    parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-c'</span><span class="token punctuation">,</span> <span class="token string">'--cexu'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'Illumina'</span><span class="token punctuation">,</span> help<span class="token operator">=</span>help<span class="token punctuation">)</span>    help <span class="token operator">=</span> u<span class="token string">"文库大小, 数据类型:int(整数型)"</span>    parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-l'</span><span class="token punctuation">,</span> <span class="token string">'--library'</span><span class="token punctuation">,</span>  type<span class="token operator">=</span>int<span class="token punctuation">,</span> help<span class="token operator">=</span>help<span class="token punctuation">)</span>    args <span class="token operator">=</span> parse<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> args<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    args <span class="token operator">=</span> parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>    output <span class="token operator">=</span> args<span class="token punctuation">.</span>output    backup <span class="token operator">=</span> args<span class="token punctuation">.</span>backup    filepath <span class="token operator">=</span> args<span class="token punctuation">.</span>filepath    project <span class="token operator">=</span> args<span class="token punctuation">.</span>project    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行 <code>python parse.py -h</code> </p><pre class="line-numbers language-bash"><code class="language-bash">usage: scanData.py <span class="token punctuation">[</span>-h<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p PROJECT<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t TYPE<span class="token punctuation">]</span> <span class="token punctuation">[</span>-c CEXU<span class="token punctuation">]</span> <span class="token punctuation">[</span>-l LIBRARY<span class="token punctuation">]</span>                   output backup <span class="token punctuation">[</span>filepath <span class="token punctuation">[</span>filepath <span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">]</span>扫描给定项目路径，生成路径下数据信息positional arguments:  output                输出文件名称  backup                已记录好的总表，如不存在可用<span class="token string">'-'</span>代替  filepath              需要扫描的项目目录,可输入多个optional arguments:  -h, --help            show this <span class="token function">help</span> message and <span class="token keyword">exit</span>  -p PROJECT, --project PROJECT                        项目名称  -t TYPE, --type TYPE  数据类型, 默认值为: FASTQ  -c CEXU, --cexu CEXU  测序平台, 默认值为: Illumina  -l LIBRARY, --library LIBRARY                        文库大小, 数据类型:int<span class="token punctuation">(</span>整数型<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以看到帮助信息是由argparse包自动生成的。且帮助信息是可以自己定义的。</p><h2 id="定位参数"><a href="#定位参数" class="headerlink" title="定位参数"></a>定位参数</h2><p>在上述程序中，<code>output</code>, <code>backup</code>, <code>filpath</code>这3个参数在帮助信息中是<code>positional arguments</code>，中文意思就是<code>定位参数</code>，用法是不用带<code>-</code>就能使用。顾名思义，这些参数的位置是固定的，前后顺序是无法更换的，且这些参数是必选的，不全的话就会报错。</p><pre class="line-numbers language-bash"><code class="language-bash">python scanData.py test.txtusage: scanData.py <span class="token punctuation">[</span>-h<span class="token punctuation">]</span> <span class="token punctuation">[</span>-p PROJECT<span class="token punctuation">]</span> <span class="token punctuation">[</span>-t TYPE<span class="token punctuation">]</span> <span class="token punctuation">[</span>-c CEXU<span class="token punctuation">]</span> <span class="token punctuation">[</span>-l LIBRARY<span class="token punctuation">]</span>                   output backup <span class="token punctuation">[</span>filepath <span class="token punctuation">[</span>filepath <span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">]</span>scanData.py: error: too few arguments<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="可选参数"><a href="#可选参数" class="headerlink" title="可选参数"></a>可选参数</h2><p>上述程序中的其他参数，在帮助信息中显示是<code>optional arguments</code>， 意思是可选参数。可以使用<code>-</code>来指定短参数，也可以使用<code>--</code>来表示长参数。可选参数是<code>非必选</code>的，可用可不用。而且顺序是可以随意更换的。</p><h2 id="参数设置"><a href="#参数设置" class="headerlink" title="参数设置"></a>参数设置</h2><p>在<code>argparse</code>中可以对参数的<code>数据类型、默认值、可选值、帮助信息</code>等进行设置。</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># !/usr/bin/python</span><span class="token comment" spellcheck="true"># -*- coding: UTF-8 -*-</span><span class="token keyword">import</span> argparseparse <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>help <span class="token operator">=</span> u<span class="token string">"文库大小, 数据类型:int(整数型)"</span>parse<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'-l'</span><span class="token punctuation">,</span> <span class="token string">'--library'</span><span class="token punctuation">,</span>  type<span class="token operator">=</span>int<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> choice<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">150</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">,</span> help<span class="token operator">=</span>help<span class="token punctuation">)</span>args <span class="token operator">=</span> parse<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在<code>add_argument</code>方法中，<code>type</code>指定数据类型，<code>default</code>指定默认值，<code>choice</code>指定可选值， <code>help</code>指定自定义帮助信息。<code>nargs</code>可以指定参数的数量，值可以为正整数，也可以为<code>*</code>表示<code>任意个数，可以为0个</code>， 还可以为<code>+</code>，代表<code>1或1以上的个数</code>。</p><p>在上述的<code>parse.py</code>中，<code>filepath</code>这个参数的个数就是不固定的，可以传入多个参数。参数解析之后，得到的是一个数组。</p><h2 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h2><p><a href="https://docs.python.org/3/library/argparse.html" target="_blank" rel="noopener">Argparse文档</a></p>]]></content>
      
      
      <categories>
          
          <category> program </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> argparse </tag>
            
            <tag> CLI </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
